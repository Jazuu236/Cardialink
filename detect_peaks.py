# Peak detection and timestamping
def detect_peaks(data, threshold, sampling_interval):
    peaks = []
    in_region = False
    max_val = None
    max_index = None
    
    for i, val in enumerate(data):
        if val > threshold:
            if not in_region:
                in_region = True
                max_val = val
                max_index = i
            else:
                if val > max_val:
                    max_val = val
                    max_index = i
        else:
            if in_region:
                timestamp_ms = max_index * sampling_interval
                peaks.append((timestamp_ms, max_val))
                in_region = False
                max_val = None
                max_index = None
                
    if in_region:
        timestamp_ms = max_index * sampling_interval
        peaks.append((timestamp_ms, max_val))
    
    return peaks

# Settings
hb_data = [32727,32824,32936,33160,33656,33768,33720,33704,33352,33480,33288,33000,32872,32840,32295,32151,32151,32215,31703,31943,31655,32007,31959,32007,32055,31975,31847,31975,32423,32311,32295,32087,32503,32231,32439,32295,31991,32295,31959,31943,31911,32167,31943,31783,32071,32039,32151,31783,32183,32071,31847,31847,31831,32231,32055,32167,31975,32103,31943,31927,32135,32295,31927,32087,32327,32039,32263,32231,32087,31927,32471,32103,32599,32583,33000,33080,33432,33448,33416,33832,33992,33944,33512,33272,33576,33112,33080,32551,32695,32167,32023,31879,32055,31959,31927,31959,31799,31607,31687,31671,31783,32103,31879,32295,32151,32295,32439,32215,32455,32103,31927,32135,31911,31895,32151,32183,31799,31735,31991,31751,31687,31751,31719,32007,31799,31767,32087,32199,32151,32039,31831,32215,32055,32215,32151,31895,32327,32231,31895,32151,32343,32311,31863,32247,32263,32215,32071,31927,32263,32295,32103,32391,32487,32776,32695,33064,33576,33816,33880,34088,34008,33944,33608,33512,33432,33352,33064,33000,32647,32487,32055,32295,32055,31927,31799,31671,31943,31959,31911,32023,32087,32087,32055,32343,32023,32199,32231,31975,32135,32055,32087,32327,32311,32055,32055,31799,32039,31895,32023,31735,31671,31703,32055,31655,32071,31719,32071,32103,31911,32103,31927,32135,32215,31815,32183,32071,32263,32103,32135,31895,31847,31815,32215,32263,32183,32199,32183,31975,32135,32215,32167,32151,32023,32167,31879,32215,32423,32551,32615,32952,33048,33528,33416,33832,34072,33832,33896,33816,33672,33080,33304,33112,32920,32359,32295,32391,32023,31687,31639,31543,31559,31927,31655,32087,32135,32295,32071,32359,32215,32407,32455,32375,32263,32199,32327,32423,32199,32087,32311,32055,32135,31751,31975,31735,31783,31847,31799,31927,32055,31831,32071,32039,32183,32087,32135,32087,31767,32167,32119,31831,32151,31847,32119,31847,32103,31943,32167,32279,32279,32183,32183,32103,32151,32007,32183,32183,32151,32087,31895,32215,32055,32599,32679,32647,32904,33128,33688,33400,33496,33896,33512,33608,33224,33192,32904,32615,32776,32295,32455,32263,32071,32039,31639,31575,31591,31895,31991,31783,32119,31751,32135,31911,32391,32183,32519,32455,32439,32439,32295,32023,32007,31927,32199,32135,31975,32167,31927,31735,32151,31767,31863,32087,32263,32087,31895,31959,31975,32231,31975,32007,32199,31879,31927,31895,32087,32199,32215,32263,32071,32167,32103,31975,32135,32279,31927,32215,31879,32263,32039,32327,32471,32295,32872,33048,33304,33336,33432,33256,33496,33432,33208,33160,33112,33112,32952,32583,32263,32167,32103,32039,32039,31623,31767,31735,31863,32087,31719,31799,32007,32183,31959,31991,32535,32151,32167,32599,32327,32167,32215,32135,32231,31959,31975,32039,32055,31895,32087,31767,31735,32007,31751,31911,32007,32135,32183,31767,32007,32087,31847,31847,32167,31815,32071,32231,31911,32279,31895,32231,31879,32215,31959,31975,32231,31959,31911,32071,32103,31927,32231,31895,32103,32423,32215,32824,32904,32840,33112,33496,33368,33384,33448,33560,33416,33592,33368,32968,32968,32615,32824,32311,32199,32055,32295,31975,31831,32087,32151,31959,32039,32055,32407,32199,32263,32087,32215,32343,32279,32199,32295,32215,32167,32391,31975,31975,32103,31975,32135,31847,32103,31879,31767,31799,32087,32023,32071,32103,32071,32055,32199,31991,31927,31991,32151,32039,32071,32167,32295,32023,32263,32439,31943,31943,31943,32023,32231,32231,32151,32279,32215,32183,32343,31943,32311,32407,32519,32711,32519,33256,33240,33176,33512,33816,33720,33672,33976,33752,33224,33464,32920,32904,32519,32599,32519,32215,31911,32055,32087,31703,32055,31943,31719,32055,32103,31815,32039,32151,32359,32119,32455,32519,32471,32327,32487,32231,32295,32455,32407,31911,31895,31895,31847,31799,32055,31927,31911,31767,31799,31863,31895,32151,31927,32183,32183,31879,32231,31831,31927,31975,32343,32231,32391,32231,32231,32135,32295,32071,32231,32215,32311,32039,31911,32183,31847,32279,32183,32279,32039,32215,32439,32872,32824,33128,33528,33768,33800,33512,33832,33320,33544,33384,33160,32936,32808,32407,32439,32183,32263,31831,32119,31879,32071,31975,32135,32183,32167,32343,32087,32103,32247,32647,32519,32279,32279,32583,32567,32471,32455,32023,32311,32151,32311,31943,31959,32263,31911,32231,31847,32167,32167,32231,32263,31975,32311,32391,31975,32023,31991,32119,32183,32007,31959,32391,32327,32215,31959,32263,32023,32135,32423,32103,32023,32087,32103,32407,32856,33096,33288,33416,33480,33720,33832,33576,33848,33768,33528,33512,33480,33224,32792,32856,32231,32103,32295,32183,31783,31783,31959,31831,31847,31879,32071,32039,32471,32487,32551,32359,32551,32311,32711,32663,32551,32663,32567,32087,32487,32311,32247,31991,32327,32007,32263,32231,32087,31927,32199,32023,32231,32263,32135,32007,32151,32311,32007,32039,32023,32471,32407,32135,32071,32391,32471,32103,32023,32343,32071,32391,32391,32391,32519,32199,32423,32599,32952,33192,33160,33384,33640,33752,34136,33960,33816,33784,33896,33448,33272,33032,33224,32984,32695,32295,32519,32391,32151,32023,32199,32215,32295,32327,32023,32407,32135,32567,32519,32647,32663,32535,32423,32519,32359,32679,32327,32535,32199,32551,32295,32039,32055,32167,32215,32231,32359,32231,31927,32007,32087,31991,32055,32423,32055,32215,32151,32055,32423,32279,32439,32487,32135,32231,32183,32439,32439,32135,32103,32359,32167,32151,32151,32359,32824,32647,33048,33368,33608,33832,33992,34312,33880,34008,34248,34136,33592,33384,33496,33048,33160,32840,32808,32295,32423,32391,32023,32279,32391,32135,32167,32199,32103,32199,32215,32263,32311,32647,32439,32872,32599,32711,32808,32391,32679,32295,32663,32279,32519,32407,32487,32375,32327,32183,32439,32135,32103,32487,32471,32103,32151,32519,32551,32487,32551,32647,32231,32359,32199,32199,32263,32455,32359,32199,32567,32327,32455,32599,32439,32375,32471,32904,32663,33224,33112,33720,33560,33720,34056,34312,34280,34072,33768,33704,33432,33480,33384,32776,32936,32776,32423,32551,32087,32311,32327,32423,32295,32359,32359,32183,32487,32695,32471,32471,32679,32872,32920,32856,32567,32647,32872,32615,32327,32519,32231]
peak_threshold = 33000
sampling_interval = 10
detected_peaks = detect_peaks(hb_data, peak_threshold, sampling_interval)

print("Detected Peaks with Timestamps (ms):")
for timestamp, value in detected_peaks:
    print(f"Time: {timestamp} ms, Peak Value: {value}")